<!DOCTYPE html>

<html>

  <!-- 

       This simple web application takes a list of addresses, plots them
       on a map, uses google maps to calculate turn by turn driving
       directions between the addresses, and plots them on a map,
       including the turn by turn directions highlight along the road
       network, instead of straight, Euclidean lines.

       The google geolocation of users current address, determined by IP
       address geolocation from google maps, only works (so far) if the
       web page is retrieved from a web server and not from the file
       server.

       There is a limit on the number and the size of the turn by turn
       directions requests made to google maps over a period of time for
       a free account. This program tries to gracefully utilize the all
       the capacity allowed and report when it has.

       The directions service query limit seems to be 10 within a
       certain amount of time. We could throttle it based on time
       perhaps.

       One objective of this web app is to generate driving time and
       driving distance metrics for a route in order to compare routes
       and route sequences.

       XXX Obsolete
       This code uses "promises" in order to execute asynchronously in a
       clean and systematic way. It's confusing however!

       XXX This code now uses a throttling mechanism to now overload
       google maps usage limits.

    -->

  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Turn By Turn Directions</title>
    <link 
       href="https://google-developers.appspot.com/maps/documentation/javascript/examples/default.css" 
       rel="stylesheet">
    
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>

    <!-- 
	 XXX, I wish I could manage these javascript files better so that they included each other ....
      -->

    <script type="text/javascript" src="jquery.js"></script>          

    <script type="text/javascript" src="moment.js"></script>          

    <script type="text/javascript" src="javascript_utilities.js"></script>          
    
    <script type="text/javascript" src="jquery_throttle_test_script.js"></script>          

    <script type="text/javascript" src="gmaps_calc_route.js"></script>          


    <!-- 
	 XXX, do styles always need to be in the <head>. Not for hmtl5, right?
      -->

    <style type='text/css'>

      #directions_panel {
      margin:20px;background-color:Lavender;
      }

      #map-canvas {
      float:left;width:70%;height:100%;
      } 

      #control_panel {
      float:right;width:30%;text-align:left;padding-top:20px;
      }
      
      #spacer {
      margin:20px;border-width:2px;
      }

    </style>

  </head>

  <body onload="initialize()">

    <div id="map-canvas"></div>

    <div id="control_panel">

      <div id="spacer">
	<br>

	<!-- 
	     XXX, is it better style to add the click handler using the onload event?
	  -->

	<input type="submit" onclick="calcRoute();">

      </div> 

      <form name="listOfLocations">

	<textarea name="inputList" rows="10" cols="30">
Samamish, WA
Bellevue, WA
Mercer Island, WA
Seattle, WA
</textarea>

<br>

<div id="status_text_area" style="border:1px solid blue">
No status, yet.
</div>

<div id="summary_metrics_text_area" style="border:1px solid blue">
No metrics, yet.
</div>

<table id="results_table" border="1">
</table>

<br>

      </form>

      <div id="directions_panel"></div>

    </div>

  </body>

</html>
